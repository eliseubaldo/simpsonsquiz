var theQuiz=function(){var e=0,a=0,t=5,n=0,s=0,i=0,d=[],o="Bart",r="",l="",c="",m=new XMLHttpRequest,u=[],p=[],f=function(){var e="simpsons.json";m.open("GET",e),m.send(),m.onreadystatechange=function(){4==m.readyState&&200==m.status?(u=JSON.parse(m.responseText),$(".loaderTxt").text("Episodes Loaded, total: "+u.length),$(".loader").fadeIn(1e3).delay(1e3).fadeOut(1e3,function(){g()})):($(".loaderTxt").text("Loading Episodes ..."),$(".loader").fadeIn(200))}},g=function(){var e="chars.json";m.open("GET",e),m.send(),m.onreadystatechange=function(){4==m.readyState&&200==m.status?(p=JSON.parse(m.responseText),window.setTimeout(function(){$(".loaderTxt").text("Opponents loaded"),$(".loader").fadeIn(1e3).delay(3e3).fadeOut(1e3,function(){h()})},1e3)):($(".loaderTxt").text("Loading Opponents ..."),$(".loader").fadeIn(200))}},h=function(){$(".pPoints").text(a),$(".cPoints").text(e),$(".welcome").slideUp(500),$(".mainGame").slideDown(),$(".computer").addClass("animated slideInLeft"),$(".yearpick").addClass("animated slideInRight"),$(".player").addClass("animated slideInLeft"),window.setTimeout(function(){$(".computer").removeClass("animated slideInLeft"),$(".yearpick").removeClass("animated slideInRight"),$(".player").removeClass("animated slideInLeft")},1e3),$(".playerName").text(o),w(),v()},w=function(){oponentTotal=p.length,s<oponentTotal?($(".oponentPic").css({"background-image":"url(images/icons/"+p[s].filename+")"}),$(".oponentName").text(p[s].charname),s++):s=0},C=function(e){"remove"==e?($(".answerBadge").hide(),$(".answerBadge").text("Wrong!"),$(".answerBadge").removeClass("rightAns animated flipInX")):"show"==e&&($(".answerBadge").show(),$(".answerBadge").addClass("animated flipInX"))},v=function(){n==t?y():(w(),C("remove"),$(".btn-answer").prop("disabled",!1),i=b(u[Math.floor(Math.random()*u.length)].airdate),$(".rndYear").text(i),d=Math.floor(Math.random()*u.length),$("#compTitle").addClass("animated slideInLeft"),$("#compTitle").text("Is The Episode: "+u[d].Title))},x=function(){var t=b(u[d].airdate);c=t>i?"after":"before",r==c&&($(".computer .answerBadge").addClass("rightAns"),$(".computer .answerBadge").text("Right!"),e++),l==c&&($(".player .answerBadge").addClass("rightAns"),$(".player .answerBadge").text("Right!"),a++),$(".btn-answer").prop("disabled",!0),C("show"),$(".pPoints").text(a),$(".cPoints").text(e),n++,$("#compTitle").removeClass("animated slideInLeft"),window.setTimeout(function(){$(".cAnswer .btn-answer").removeClass("btChoice"),$(".pAnswer .btn-answer").removeClass("btChoice"),v()},2e3)},y=function(){$(".computer").addClass("animated slideOutLeft"),$(".yearpick").addClass("animated slideOutRight"),$(".player").addClass("animated slideOutLeft"),$(".mainGame").fadeOut(),$(".endQuiz").show(),$(".endQuiz").addClass("animated slideInLeft"),e=0,a=0,n=1},b=function(e){var a=e.length,t=e.slice(-4,a);return t},T=function(){var e=$(".inputPlayer").val();e?(o=e,$(".playerPic").css({"background-image":"url(images/icons/player_icon.png)"})):$(".playerPic").css({"background-image":"url(images/icons/Bart_icon.png)"}),f()},I=function(e){$(this).addClass("btChoice"),l=e;var a=Math.floor(2*Math.random());a?($('.cAnswer .btn-answer[data-asw="before"]').addClass("btChoice"),r="before"):($('.cAnswer .btn-answer[data-asw="after"]').addClass("btChoice"),r="after"),x()},L=function(){$(".endQuiz").fadeOut(),$(".computer").removeClass("animated slideOutLeft"),$(".yearpick").removeClass("animated slideOutRight"),$(".player").removeClass("animated slideOutLeft"),h()},O={};return O.initialize=function(){T()},O.answer=function(e){I(e)},O.restart=function(){L()},O}();